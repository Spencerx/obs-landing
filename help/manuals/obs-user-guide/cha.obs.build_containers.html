<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>User Guide | Build Containers</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Build Containers"/>
<meta name="description" content=""/>
<meta name="book-title" content="User Guide"/>
<meta name="chapter-title" content="Chapter 24. Build Containers"/>
<meta name="tracker-url" content="https://github.com/SUSE/obs-docu/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Build Containers"/>
<meta property="og:description" content=""/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Build Containers"/>
<meta name="twitter:description" content=""/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Product &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Build Containers",
  
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha.obs.build_process.html" title="Chapter 23. Build Process"/><link rel="next" href="cha.obs.source_management.html" title="Chapter 25. Source Management"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">User Guide</a><span> / </span><a class="crumb" href="par.reference.html">Reference</a><span> / </span><a class="crumb" href="cha.obs.build_containers.html">Build Containers</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">User Guide</div><ol><li><a href="bk01pr01.html" class=" "><span class="title-number"> </span><span class="title-name">About this Guide</span></a></li><li><a href="par.first_steps.html" class="has-children "><span class="title-number">I </span><span class="title-name">First Steps</span></a><ol><li><a href="art.obs.bg.html" class=" "><span class="title-number">1 </span><span class="title-name">Beginnerʼs Guide</span></a></li></ol></li><li><a href="par.concepts.html" class="has-children "><span class="title-number">II </span><span class="title-name">Concepts</span></a><ol><li><a href="cha.obs.package_formats.html" class=" "><span class="title-number">2 </span><span class="title-name">Supported Build Recipes and Package Formats</span></a></li></ol></li><li><a href="bk01pt03.html" class="has-children "><span class="title-number">III </span><span class="title-name">Setup</span></a><ol><li><a href="cha.obs.osc.html" class=" "><span class="title-number">3 </span><span class="title-name">osc, the Command Line Tool</span></a></li><li><a href="cha.obs.prjconfig.html" class=" "><span class="title-number">4 </span><span class="title-name">Build Configuration</span></a></li></ol></li><li><a href="par.working.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Usage</span></a><ol><li><a href="cha.obs.basicworkflow.html" class=" "><span class="title-number">5 </span><span class="title-name">Basic OBS Workflow</span></a></li><li><a href="cha.obs.building.html" class=" "><span class="title-number">6 </span><span class="title-name">Local Building</span></a></li><li><a href="cha.obs.source_service.html" class=" "><span class="title-number">7 </span><span class="title-name">Using Source Services</span></a></li><li><a href="cha.obs.scm_ci_workflow_integration.html" class=" "><span class="title-number">8 </span><span class="title-name">SCM/CI Workflow Integration</span></a></li><li><a href="cha.obs.stagingworkflow.html" class=" "><span class="title-number">9 </span><span class="title-name">Staging Workflow</span></a></li><li><a href="cha.obs.notifications.html" class=" "><span class="title-number">10 </span><span class="title-name">Notifications</span></a></li><li><a href="cha.obs.moderation.html" class=" "><span class="title-number">11 </span><span class="title-name">Moderation</span></a></li></ol></li><li><a href="par.best_practices.html" class="has-children "><span class="title-number">V </span><span class="title-name">Best Practices</span></a><ol><li><a href="cha.obs.best-practices.webuiusage.html" class=" "><span class="title-number">12 </span><span class="title-name">Using the OBS Web UI</span></a></li><li><a href="cha.obs.best-practices.basics.html" class=" "><span class="title-number">13 </span><span class="title-name">Basic Concepts and Work Styles</span></a></li><li><a href="cha.obs.best-practices.scm_integration.html" class=" "><span class="title-number">14 </span><span class="title-name">How to integrate external SCM sources</span></a></li><li><a href="cha.obs.best-practices.upstream.html" class=" "><span class="title-number">15 </span><span class="title-name">Publishing Upstream Binaries</span></a></li><li><a href="cha.obs.best-practices.bootstrapping.html" class=" "><span class="title-number">16 </span><span class="title-name">Bootstrapping</span></a></li><li><a href="cha.obs.best-practices.oscexamples.html" class=" "><span class="title-number">17 </span><span class="title-name"><code class="command">osc</code> Example Commands</span></a></li><li><a href="cha.obs.best-practices.advanced.html" class=" "><span class="title-number">18 </span><span class="title-name">Advanced Project Setups</span></a></li><li><a href="cha.obs.best-practices.kmp.html" class=" "><span class="title-number">19 </span><span class="title-name">Building Kernel Modules</span></a></li><li><a href="cha.obs.best-practices.howto.html" class=" "><span class="title-number">20 </span><span class="title-name">Common Questions and Solutions</span></a></li></ol></li><li class="active"><a href="par.reference.html" class="has-children you-are-here"><span class="title-number">VI </span><span class="title-name">Reference</span></a><ol><li><a href="cha.obs.architecture.html" class=" "><span class="title-number">21 </span><span class="title-name">OBS Architecture</span></a></li><li><a href="cha.obs.concepts.html" class=" "><span class="title-number">22 </span><span class="title-name">OBS Concepts</span></a></li><li><a href="cha.obs.build_process.html" class=" "><span class="title-number">23 </span><span class="title-name">Build Process</span></a></li><li><a href="cha.obs.build_containers.html" class=" you-are-here"><span class="title-number">24 </span><span class="title-name">Build Containers</span></a></li><li><a href="cha.obs.source_management.html" class=" "><span class="title-number">25 </span><span class="title-name">Source Management</span></a></li><li><a href="cha.obs.scm_bridge.html" class=" "><span class="title-number">26 </span><span class="title-name">SCM Bridge</span></a></li><li><a href="cha.obs.supported_formats.html" class=" "><span class="title-number">27 </span><span class="title-name">Supported Formats</span></a></li><li><a href="cha.obs.request_and_review_system.html" class=" "><span class="title-number">28 </span><span class="title-name">Request And Review System</span></a></li><li><a href="cha.obs.image_templates.html" class=" "><span class="title-number">29 </span><span class="title-name">Image Templates</span></a></li><li><a href="cha.obs.multibuild.html" class=" "><span class="title-number">30 </span><span class="title-name">Multiple Build Description File Handling</span></a></li><li><a href="cha.obs.maintenance_setup.html" class=" "><span class="title-number">31 </span><span class="title-name">Maintenance Support</span></a></li><li><a href="cha.obs.binary_tracking.html" class=" "><span class="title-number">32 </span><span class="title-name">Binary Package Tracking</span></a></li><li><a href="cha.obs.admin.html" class=" "><span class="title-number">33 </span><span class="title-name">Administration</span></a></li><li><a href="cha.obs.build_scheduling_and_dispatching.html" class=" "><span class="title-number">34 </span><span class="title-name">Scheduling and Dispatching</span></a></li><li><a href="cha.obs.build_constraints.html" class=" "><span class="title-number">35 </span><span class="title-name">Build Constraints</span></a></li><li><a href="cha.obs.build_preinstall.html" class=" "><span class="title-number">36 </span><span class="title-name">Building Preinstall Images</span></a></li><li><a href="cha.obs.authorization.token.html" class=" "><span class="title-number">37 </span><span class="title-name">Authorization</span></a></li><li><a href="cha.obs.qa_hooks.html" class=" "><span class="title-number">38 </span><span class="title-name">Quality Assurance(QA) Hooks</span></a></li><li><a href="cha.obs.factory.html" class=" "><span class="title-number">39 </span><span class="title-name">openSUSE Factory</span></a></li></ol></li><li><a href="obs.glossary.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="bk01apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU Licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha.obs.build_containers" data-id-title="Build Containers"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">24 </span><span class="title-name">Build Containers</span></span> <a title="Permalink" class="permalink" href="cha.obs.build_containers.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div><div><div class="abstract"/></div></div></div><p>
  Containers are workloads which embed all necessary files to make the workload
  independent of the running host OS. This includes (but is not limited to)
  libraries, executables and shared resource files.
 </p><section class="sect1" id="_supported_formats" data-id-title="Supported Container Formats"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">24.1 </span><span class="title-name">Supported Container Formats</span></span> <a title="Permalink" class="permalink" href="cha.obs.build_containers.html#_supported_formats">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
   A container that is providing its own kernel is commonly called a virtual
   machine and will be referred to as such in this book. The Open Build Service
   (OBS) supports container builds either by supporting the native build format
   or as side product of a different format. This ranges is from very simple
   chroot containers over server (for example, Docker) or desktop formats (for
   example, AppImages, Snaps or Flatpaks) up to full VM builds (such as for
   OpenStack, KVM, or as a Live CD via KIWI).
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.2.10.5.4.3.1"><span class="term">SimpleImage</span></dt><dd><p>
      SimpleImage is a special format which uses the rpm spec file syntax and
      just packages the resulting install root as tar ball or squashfs image.
      The format is just using the BuildRequires tags from a file called
      <code class="filename">simpleimage</code>, it supports also rpm macro handling to
      allow for exceptions depending on the build environment.
     </p></dd><dt id="id-1.2.10.5.4.3.2"><span class="term">Docker</span></dt><dd><p>
      Docker images can be built either via the KIWI tool or from
      Dockerfile build descriptions.
     </p></dd><dt id="id-1.2.10.5.4.3.3"><span class="term">AppImage</span></dt><dd><p>
      The desktop-oriented AppImage format is currently only created as a side
      effect of an RPM build. Open Build Service (OBS) supports signing and
      publishing the .AppImage files, the rest is handled via wrapper packages
      which converts an RPM (or DEB package) into an AppImage file. Own build
      rules can provided via a <code class="filename">Recipe</code> file, fallback code
      will be used if no <code class="filename">Recipe</code> file is available.
     </p></dd><dt id="id-1.2.10.5.4.3.4"><span class="term">Snap</span></dt><dd><p>
      The Snap format is supported natively. However, external resources are
      only supported via source services and therefore not all build types are
      supported. Snapcraft only works with Ubuntu-based base systems. (Code to
      support RPM-based distributions exists as well but has not been merged
      upstream yet.)
     </p></dd><dt id="id-1.2.10.5.4.3.5"><span class="term">Flatpak</span></dt><dd><p>
      Flatpak packages can be built in the Open Build Service, see
      <a class="xref" href="cha.obs.package_formats.html#sec.pkgfmt.flatpak" title="2.8. Flatpak">Section 2.8, “Flatpak”</a> for further details.
     </p></dd><dt id="id-1.2.10.5.4.3.6"><span class="term">Livebuild</span></dt><dd><p>
      Livebuild is the Debian livebuild support for ISO images.
     </p></dd><dt id="id-1.2.10.5.4.3.7"><span class="term">Mkosi</span></dt><dd><p>
      <a class="link" href="https://github.com/systemd/mkosi/" target="_blank">Mkosi</a> allows
      building images for rpm, arch, deb, and gentoo based distributions, see
      <a class="xref" href="cha.obs.package_formats.html#sec.pkgfmt.mkosi" title="2.9. mkosi">Section 2.9, “mkosi”</a> for further details.
     </p></dd></dl></div></section><section class="sect1" id="_container_registry" data-id-title="Container Registry"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">24.2 </span><span class="title-name">Container Registry</span></span> <a title="Permalink" class="permalink" href="cha.obs.build_containers.html#_container_registry">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
   Container Registries are repositories that container images are published
   and can be automatically pulled from using tools like
   <a class="link" href="https://podman.io/" target="_blank">podman</a> or
   <a class="link" href="https://www.docker.com/" target="_blank">docker</a>.
  </p><p>
   The Open Build Service will automatically publish container images in a
   OCI-compatible registry, with the URLs to the images constructed as follows:
   <code class="literal"> $BASE/$PROJECT/$REPOSITORY/$IMAGE_NAME:$TAG </code> with the
   following components:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      <code class="literal">$BASE</code>: URL/IP under which the Open Build Service
      instance is reachable
     </p></li><li class="listitem"><p>
      <code class="literal">$PROJECT</code>: The name of the project where the image is
      build, with all colons replaced with forward slashes.
     </p></li><li class="listitem"><p>
      <code class="literal">$REPOSITORY</code>: The name of the repository where the
      containers are published.
     </p></li><li class="listitem"><p>
      <code class="literal">$IMAGE_NAME</code>: The name of this container image. It
      defaults to the name of the package from which the container is build.
      Alternatively, a different image name can be specified in the build
      recipe, e.g. via the <code class="literal">containerconfig</code> element in a
      KIWI file (see
      <a class="link" href="https://osinside.github.io/kiwi/building_images/build_docker_container.html?highlight=containerconfig" target="_blank">the
      kiwi documentation</a> for further details).
     </p></li><li class="listitem"><p>
      <code class="literal">$TAG</code>: The image tag. This defaults to
      <code class="literal">latest</code> with alternatives being provided in a similar
      fashion as the image's name.
     </p></li></ul></div><p>
  </p><p>
   The
   <a class="link" href="https://github.com/openSUSE/cooverview" target="_blank">cooverview</a>
   project provides a simple user-facing webpage to search for containers
   published by the Open Build Service and can be used to conveniently obtain
   the correct registry URLs. It is used to power
   <a class="link" href="https://registry.opensuse.org/" target="_blank">registry.opensuse.org</a>
  </p></section><section class="sect1" id="_image_signatures" data-id-title="Container Image Signatures"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">24.3 </span><span class="title-name">Container Image Signatures</span></span> <a title="Permalink" class="permalink" href="cha.obs.build_containers.html#_image_signatures">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
   The Open Build Service automatically signs every package that has been build and
   publishes the cryptographic signature alongside with it. Container images
   are no exception to this and the detached signatures can be used by
   <a class="link" href="https://podman.io/" target="_blank">podman</a> to verify every image
   that is pulled from the registry.
  </p><p>
   Podman has to be configured first as outlined in the following steps.
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Create a <code class="literal">yaml</code> file under
     <code class="literal">/etc/containers/registries.d/</code> with an appropriate name
     for your instance and the following contents:
     </p><div class="example" id="id-1.2.10.5.6.4.1.1.3" data-id-title="registry.yaml"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 24.1: </span><span class="title-name">registry.yaml </span></span><a title="Permalink" class="permalink" href="cha.obs.build_containers.html#id-1.2.10.5.6.4.1.1.3">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">---
docker:
  <em class="replaceable">REGISTRY_URL</em>:
    sigstore: <em class="replaceable">REGISTRY_URL</em>/sigstore</pre></div></div></div><p>
     Replace <em class="replaceable">REGISTRY_URL</em> with the appropriate URL
     to your instance of Open Build Service (for example,
     <code class="literal">registry.opensuse.org</code>).
    </p></li><li class="listitem"><p>
     Add the following object into the key <code class="literal">transports</code> in the
     file <code class="filename">/etc/containers/policy.json</code>:
    </p><div class="example" id="id-1.2.10.5.6.4.2.2" data-id-title="policy.json"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 24.2: </span><span class="title-name">policy.json </span></span><a title="Permalink" class="permalink" href="cha.obs.build_containers.html#id-1.2.10.5.6.4.2.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">    "docker": {
      "<em class="replaceable">REGISTRY_URL</em>": [
        {
          "type": "signedBy",
          "keyType": "GPGKeys",
          "keyPath": "<em class="replaceable">PATH_TO_PUBLIC_KEY</em>"
        }
      ]
    }</pre></div></div></div><p>
     The complete <code class="filename">/etc/containers/policy.json</code> can then
     look like this:
    </p><div class="example" id="id-1.2.10.5.6.4.2.4" data-id-title="policy.json"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 24.3: </span><span class="title-name">policy.json </span></span><a title="Permalink" class="permalink" href="cha.obs.build_containers.html#id-1.2.10.5.6.4.2.4">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">{
  "default": [
    {
      "type": "insecureAcceptAnything"
    }
  ],
  "transports": {
    "docker-daemon": {
      "": [
        {
          "type": "insecureAcceptAnything"
        }
      ]
    },
    "docker": {
      "<em class="replaceable">REGISTRY_URL</em>": [
        {
          "type": "signedBy",
          "keyType": "GPGKeys",
          "keyPath": "<em class="replaceable">PATH_TO_PUBLIC_KEY</em>"
        }
      ]
    }
  }
}</pre></div></div></div></li><li class="listitem"><p>
     Save the public key of the project where your image is build under
     <em class="replaceable">PATH_TO_PUBLIC_KEY</em> (you can choose any location
     to which you have read access, only ensure that you specify it in
     <code class="filename">/etc/containers/policy.json</code> as well).
    </p></li></ul></div><p>
   Podman will from now on automatically fetch the published signatures from
   the backend and verify them before storing the images locally.
  </p></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha.obs.build_process.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 23 </span>Build Process</span></a> </div><div><a class="pagination-link next" href="cha.obs.source_management.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 25 </span>Source Management</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha.obs.build_containers.html#_supported_formats"><span class="title-number">24.1 </span><span class="title-name">Supported Container Formats</span></a></span></li><li><span class="sect1"><a href="cha.obs.build_containers.html#_container_registry"><span class="title-number">24.2 </span><span class="title-name">Container Registry</span></a></span></li><li><span class="sect1"><a href="cha.obs.build_containers.html#_image_signatures"><span class="title-number">24.3 </span><span class="title-name">Container Image Signatures</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>