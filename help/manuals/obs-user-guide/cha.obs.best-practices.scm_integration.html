<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>User Guide | How to integrate external SCM sources</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="How to integrate external SCM sources"/>
<meta name="description" content="Application development usually happens in SCM systems like git, subversion, mercurial and alike. These external sources can be used directly in OBS …"/>
<meta name="book-title" content="User Guide"/>
<meta name="chapter-title" content="Chapter 14. How to integrate external SCM sources"/>
<meta name="tracker-url" content="https://github.com/openSUSE/obs-docu/issues/new"/>
<meta name="tracker-type" content="gh"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="How to integrate external SCM sources"/>
<meta property="og:description" content="Application development usually happens in SCM systems like…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to integrate external SCM sources"/>
<meta name="twitter:description" content="Application development usually happens in SCM systems like…"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Product &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "How to integrate external SCM sources",
  
    "description": "How to integrate external SCM sources",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha.obs.best-practices.basics.html" title="Chapter 13. Basic Concepts and Work Styles"/><link rel="next" href="cha.obs.best-practices.upstream.html" title="Chapter 15. Publishing Upstream Binaries"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="wide offline js-off"><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"/></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">User Guide</a><span> / </span><a class="crumb" href="par.best_practices.html">Best Practices</a><span> / </span><a class="crumb" href="cha.obs.best-practices.scm_integration.html">How to integrate external SCM sources</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">User Guide</div><ol><li><a href="bk01pr01.html" class=" "><span class="title-number"> </span><span class="title-name">About this Guide</span></a></li><li><a href="par.first_steps.html" class="has-children "><span class="title-number">I </span><span class="title-name">First Steps</span></a><ol><li><a href="art.obs.bg.html" class=" "><span class="title-number">1 </span><span class="title-name">Beginnerʼs Guide</span></a></li></ol></li><li><a href="par.concepts.html" class="has-children "><span class="title-number">II </span><span class="title-name">Concepts</span></a><ol><li><a href="cha.obs.package_formats.html" class=" "><span class="title-number">2 </span><span class="title-name">Supported Build Recipes and Package Formats</span></a></li></ol></li><li><a href="bk01pt03.html" class="has-children "><span class="title-number">III </span><span class="title-name">Setup</span></a><ol><li><a href="cha.obs.osc.html" class=" "><span class="title-number">3 </span><span class="title-name">osc, the Command Line Tool</span></a></li><li><a href="cha.obs.prjconfig.html" class=" "><span class="title-number">4 </span><span class="title-name">Build Configuration</span></a></li></ol></li><li><a href="par.working.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Usage</span></a><ol><li><a href="cha.obs.basicworkflow.html" class=" "><span class="title-number">5 </span><span class="title-name">Basic OBS Workflow</span></a></li><li><a href="cha.obs.building.html" class=" "><span class="title-number">6 </span><span class="title-name">Local Building</span></a></li><li><a href="cha.obs.source_service.html" class=" "><span class="title-number">7 </span><span class="title-name">Using Source Services</span></a></li><li><a href="cha.obs.scm_ci_workflow_integration.html" class=" "><span class="title-number">8 </span><span class="title-name">SCM/CI Workflow Integration</span></a></li><li><a href="cha.obs.stagingworkflow.html" class=" "><span class="title-number">9 </span><span class="title-name">Staging Workflow</span></a></li><li><a href="cha.obs.notifications.html" class=" "><span class="title-number">10 </span><span class="title-name">Notifications</span></a></li><li><a href="cha.obs.moderation.html" class=" "><span class="title-number">11 </span><span class="title-name">Moderation</span></a></li></ol></li><li class="active"><a href="par.best_practices.html" class="has-children you-are-here"><span class="title-number">V </span><span class="title-name">Best Practices</span></a><ol><li><a href="cha.obs.best-practices.webuiusage.html" class=" "><span class="title-number">12 </span><span class="title-name">Using the OBS Web UI</span></a></li><li><a href="cha.obs.best-practices.basics.html" class=" "><span class="title-number">13 </span><span class="title-name">Basic Concepts and Work Styles</span></a></li><li><a href="cha.obs.best-practices.scm_integration.html" class=" you-are-here"><span class="title-number">14 </span><span class="title-name">How to integrate external SCM sources</span></a></li><li><a href="cha.obs.best-practices.upstream.html" class=" "><span class="title-number">15 </span><span class="title-name">Publishing Upstream Binaries</span></a></li><li><a href="cha.obs.best-practices.bootstrapping.html" class=" "><span class="title-number">16 </span><span class="title-name">Bootstrapping</span></a></li><li><a href="cha.obs.best-practices.oscexamples.html" class=" "><span class="title-number">17 </span><span class="title-name"><code class="command">osc</code> Example Commands</span></a></li><li><a href="cha.obs.best-practices.advanced.html" class=" "><span class="title-number">18 </span><span class="title-name">Advanced Project Setups</span></a></li><li><a href="cha.obs.best-practices.kmp.html" class=" "><span class="title-number">19 </span><span class="title-name">Building Kernel Modules</span></a></li><li><a href="cha.obs.best-practices.howto.html" class=" "><span class="title-number">20 </span><span class="title-name">Common Questions and Solutions</span></a></li></ol></li><li><a href="par.reference.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Reference</span></a><ol><li><a href="cha.obs.architecture.html" class=" "><span class="title-number">21 </span><span class="title-name">OBS Architecture</span></a></li><li><a href="cha.obs.concepts.html" class=" "><span class="title-number">22 </span><span class="title-name">OBS Concepts</span></a></li><li><a href="cha.obs.build_process.html" class=" "><span class="title-number">23 </span><span class="title-name">Build Process</span></a></li><li><a href="cha.obs.build_containers.html" class=" "><span class="title-number">24 </span><span class="title-name">Build Containers</span></a></li><li><a href="cha.obs.source_management.html" class=" "><span class="title-number">25 </span><span class="title-name">Source Management</span></a></li><li><a href="cha.obs.scm_bridge.html" class=" "><span class="title-number">26 </span><span class="title-name">SCM Bridge</span></a></li><li><a href="cha.obs.supported_formats.html" class=" "><span class="title-number">27 </span><span class="title-name">Supported Formats</span></a></li><li><a href="cha.obs.request_and_review_system.html" class=" "><span class="title-number">28 </span><span class="title-name">Request And Review System</span></a></li><li><a href="cha.obs.image_templates.html" class=" "><span class="title-number">29 </span><span class="title-name">Image Templates</span></a></li><li><a href="cha.obs.multibuild.html" class=" "><span class="title-number">30 </span><span class="title-name">Multiple Build Description File Handling</span></a></li><li><a href="cha.obs.maintenance_setup.html" class=" "><span class="title-number">31 </span><span class="title-name">Maintenance Support</span></a></li><li><a href="cha.obs.binary_tracking.html" class=" "><span class="title-number">32 </span><span class="title-name">Binary Package Tracking</span></a></li><li><a href="cha.obs.admin.html" class=" "><span class="title-number">33 </span><span class="title-name">Administration</span></a></li><li><a href="cha.obs.build_scheduling_and_dispatching.html" class=" "><span class="title-number">34 </span><span class="title-name">Scheduling and Dispatching</span></a></li><li><a href="cha.obs.build_constraints.html" class=" "><span class="title-number">35 </span><span class="title-name">Build Constraints</span></a></li><li><a href="cha.obs.build_preinstall.html" class=" "><span class="title-number">36 </span><span class="title-name">Building Preinstall Images</span></a></li><li><a href="cha.obs.authorization.token.html" class=" "><span class="title-number">37 </span><span class="title-name">Authorization</span></a></li><li><a href="cha.obs.qa_hooks.html" class=" "><span class="title-number">38 </span><span class="title-name">Quality Assurance(QA) Hooks</span></a></li><li><a href="cha.obs.factory.html" class=" "><span class="title-number">39 </span><span class="title-name">openSUSE Factory</span></a></li></ol></li><li><a href="obs.glossary.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="bk01apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU Licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha.obs.best-practices.scm_integration" data-id-title="How to integrate external SCM sources"><div class="titlepage"><div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">14 </span><span class="title-name">How to integrate external SCM sources</span></span> <a title="Permalink" class="permalink" href="cha.obs.best-practices.scm_integration.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
     Application development usually happens in SCM systems like git, subversion, mercurial
     and alike. These external sources can be used directly in OBS via source services.
     OBS will always keep a copy of the sources to guarantee that the build sources
     are still available even when the external SCM server disappears or get altered.
   </p><section class="sect1" id="id-1.2.9.4.4" data-id-title="How to create a source service"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">14.1 </span><span class="title-name">How to create a source service</span></span> <a title="Permalink" class="permalink" href="cha.obs.best-practices.scm_integration.html#id-1.2.9.4.4">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
      Let OBS create a tar ball out of an SCM repository. This just creates or
      extend a _service file with some rules how to download and package sources.
      The actual work happens on a local build or on a service side build. Please
      note that you need the obs-service-obs_scm installed for local runs.
     </p><div class="verbatim-wrap"><pre class="screen">       <code class="command">
# osc add https://SOME_URL.git
       </code></pre></div><p>
      The web interface is creating as well a _service file when adding an URL
      to a SCM system.
     </p><section class="sect2" id="id-1.2.9.4.4.5" data-id-title="Follow upstream branches"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">14.1.1 </span><span class="title-name">Follow upstream branches</span></span> <a title="Permalink" class="permalink" href="cha.obs.best-practices.scm_integration.html#id-1.2.9.4.4.5">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
       The created _service file is set up to follow latest source submissions on each
       run and looks like this:
       </p><div class="verbatim-wrap"><pre class="screen">          <code class="command">
&lt;services&gt;
  &lt;service name="obs_scm"&gt;
    &lt;param name="url"&gt;https://github.com/FreeCAD/FreeCAD.git&lt;/param&gt;
    &lt;param name="scm"&gt;git&lt;/param&gt;
  &lt;/service&gt;

  &lt;service name="set_version" mode="buildtime"/&gt;
  &lt;service name="tar" mode="buildtime"/&gt;
  &lt;service name="recompress" mode="buildtime"&gt;
    &lt;param name="file"&gt;*.tar&lt;/param&gt;
    &lt;param name="compression"&gt;xz&lt;/param&gt;
  &lt;/service&gt;
&lt;/services&gt;
          </code></pre></div><p>
        This will create an obscpio archive via the obs_scm service with the latest sources. 
        This archive will get extracted at build time and be processed via the other services
        to build a compressed tar ball for rpmbuild. 
        To follow a specific branch and additional parameter for "revision" is needed for the
        obs_scm service.
       </p></section><section class="sect2" id="id-1.2.9.4.4.6" data-id-title="Fixed versions"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">14.1.2 </span><span class="title-name">Fixed versions</span></span> <a title="Permalink" class="permalink" href="cha.obs.best-practices.scm_integration.html#id-1.2.9.4.4.6">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
         You may want to build an archive for a fixed version, for example an official release
         which has been tagged by the upstream project. It is recommend to specify the 
         mode="disabled" and to submit the archive via the following
       </p><div class="verbatim-wrap"><pre class="screen">          <code class="command">
# osc service runall
# osc ar
# osc commit
          </code></pre></div><p>
        commands.
       </p></section><section class="sect2" id="id-1.2.9.4.4.7" data-id-title="Avoid tar balls"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">14.1.3 </span><span class="title-name">Avoid tar balls</span></span> <a title="Permalink" class="permalink" href="cha.obs.best-practices.scm_integration.html#id-1.2.9.4.4.7">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
         Tar balls are not a requirement by OBS, but by the packaging tool, for example, rpmbuild. However,
         you may want to decide not to ship a tar ball inside of the src.rpm. This makes sense for
         large sources where the compression time and needed disk space is just considered a waste
         for short living builds and where full source packages are not a requirement.
         You can simplify your _service file in that case, but you need to help rpmbuild to work directly in the source.
         Since RPM will not include the OBS provided SCM sources in the src.rpm,
         it is also a good practice to package the _service file instead of the tar ball to
         give the user a chance to rebuild the src.rpm as long the external SCM server is
         providing the sources. The simplified _service file looks like this:
       </p><div class="verbatim-wrap"><pre class="screen">          <code class="command">
&lt;services&gt;
  &lt;service name="obs_scm"&gt;
    &lt;param name="url"&gt;https://github.com/FreeCAD/FreeCAD.git&lt;/param&gt;
    &lt;param name="scm"&gt;git&lt;/param&gt;
  &lt;/service&gt;

  &lt;service name="set_version" mode="buildtime"/&gt;
&lt;/services&gt;
          </code></pre></div><p>
        The spec file needs some hints to build inside the extracted sources directly. The macro
        can be used to switch to build tar balls or not to keep it working for stable releases where
        you want to provide a complete source RPM.
       </p><div class="verbatim-wrap"><pre class="screen">          <code class="command">
...
%define build_tar_ball 0
...
%if %{build_tar_ball}
Source0:        %{name}-%version.tar.xz
%else
Source0:        _service
%endif
...
%prep
%if %{build_tar_ball}
 %setup -q
%else
 %setup -q -n %_sourcedir/%name-%version -T -D
%endif
          </code></pre></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha.obs.best-practices.basics.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 13 </span>Basic Concepts and Work Styles</span></a> </div><div><a class="pagination-link next" href="cha.obs.best-practices.upstream.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 15 </span>Publishing Upstream Binaries</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha.obs.best-practices.scm_integration.html#id-1.2.9.4.4"><span class="title-number">14.1 </span><span class="title-name">How to create a source service</span></a></span></li></ul></div> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>